
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watch Tower - Weekly Monitor</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #e0e0e0; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #2d2d2d; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #4caf50; }
        
        /* Login Area */
        #login-area { text-align: center; margin-top: 50px; }
        input { padding: 10px; font-size: 1.2rem; border-radius: 5px; border: 1px solid #444; background: #333; color: white; width: 150px; text-align: center; }
        button { padding: 10px 20px; font-size: 1.2rem; border-radius: 5px; border: none; background-color: #4caf50; color: white; cursor: pointer; margin-left: 10px; }
        button:hover { background-color: #45a049; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
        
        /* Content Area */
        #content-area { display: none; }
        
        /* Table Styles */
        table.dataTable tbody tr { background-color: #2d2d2d; color: #e0e0e0; }
        table.dataTable tbody tr:hover { background-color: #383838; }
        table.dataTable thead th { border-bottom: 1px solid #444; color: #4caf50; }
        table.dataTable td { border-bottom: 1px solid #444; }
        
        /* Links */
        a { color: #64b5f6; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        
        /* Utilities */
        .hidden-data { display: none; }
        .metric-pos { color: #81c784; }
        .metric-neg { color: #e57373; }
    </style>
    
    <!-- jQuery & DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîê Weekly Sector Monitor</h1>
        
        <div id="login-area">
            <p>Please enter the 4-digit PIN to unlock.</p>
            <input type="password" id="pin-input" maxlength="4" placeholder="PIN" autofocus>
            <button onclick="unlock()">Unlock</button>
            <p class="error" id="error-msg">Incorrect PIN</p>
        </div>

        <div id="content-area">
            <h3>ÊùøÂ°äËº™ÂãïÊéíÂêç (Sector Rotation Ranking)</h3>
            <table id="sector-table" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Ticker</th>
                        <th>Name (Chinese)</th>
                        <th>4-Week %</th>
                        <th>12-Week %</th>
                        <th>RS Score</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            
            <hr style="margin: 30px 0; border-color: #444;">
            
            <h3>ÂÆåÊï¥Â†±Âëä (Full Report Text)</h3>
            <pre id="raw-report" style="background: #111; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas;"></pre>
        </div>
    </div>
    
    <div id="encrypted-data" class="hidden-data">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FAwUEGpDAwtSB2hHAAQMAmpDDAJXBxQaYlNXWlhZWF1RTx0QGhYWQlNEUm0CQRYIFhsEHAYCBAcABwQGBgYHAwQPBwoFAxgSFEZRQFBpBQBBFA4SGwYaAgcCAAYFBwICDwMGBQUFDQoaFhZBVVlGVxQMFB8GGAQBBQMFBAIDAQsCBgQFDwADT2saFBBEU0RdREJrRlNOQBAMFhZuQwBWUVBqQQsGBQVuQwADBVBqQQcOAlVuQw5SAFdqQQcEUgFuQwECVwVqQQRTBFduWAsJDwsLCQ8LCwkPCwsJDwsLCQ8LCwkPCwsJDwsLCQ8LCwkPCwsJDwtqWm5DBAEHBGpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAAG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEEAmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAAG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAAG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDAW5YakEAAwYGEhYWaEcABQ0AakMBBgZSFG5DBAECBBZoRwABA1RqQwEKAlcUEhZqQQADBgYSAmpBCwYFBW5DDgwEDmpBBQVQURIWFmhHBAMEABYHBm5DDwQBB2pBCg4ADG5DAQdUUxYUEmpDBgcGBBQSFhZmYWpDAQAGAGhHAAMDChZqQQADBgZuWGpBAAMDUW5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEEV2pBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAVW5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEEV2pBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEEV2pBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEEB2pabkMEAQIEFhQSFgcUbkMEAQIEFmx+cxYUbkMEAQIEFgUGGAcCFxZqQQADBgYSBAcaAQMTFBJqQwYHBgQUEgYYBQUHAxRuQwQBAgRqWm5DBAEDVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMEAG5YakEAAwYGEhYWFAAWakEAAwYGEm56dhIWakEAAwYGEg4YDAoTFhRuQwQBAgQWBgcYAgYXFhZoRwQDBAAWFgQcBwABBxZqQQADBgZuWGpBAAMHV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEAAmpabkMEAQIEFhQSFgUUbkMEAQIEFmx+ZhYUbkMEAQIEFgwcAAEREhZqQQADBgYSBwEaBwUTFBJqQwYHBgQUEgYYBQADFhRuQwQBAgRqWm5DBAEDVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMEAG5YakEAAwYGEhYWFAYWakEAAwYGEm56fRIWakEAAwYGEgMYBAQTFhRuQwQBAgQWBQQYBwUXFhZoRwQDBAAWFgQcBg8NChZqQQADBgZuWGpBAAMHV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEAAmpabkMEAQIEFhQSFgMUbkMEAQIEFmx+ZHMUbkMEAQIEFgAcBQQREhZqQQADBgYSDhgFAhMWFBJqQwYHBgQUEgYYBAcABxRuQwQBAgRqWm5DBAEDVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMEAG5YakEAAwYGEhYWFAQWakEAAwYGEm56YRIWakEAAwYGEgAYAgETFhRuQwQBAgQWABwABBESFhZoRwQDBAAWFgQcBgMEABZqQQADBgZuWGpBAAMHV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEAAmpabkMEAQIEFhQSFgEUbkMEAQIEFmx+YBYUbkMEAQIEFgQcAgMREhZqQQADBgYSAhgHChMWFBJqQwYHBgQUEgYYBAMOBxRuQwQBAgRqWm5DBAEDVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMEAG5YakEAAwYGEhYWFAoWakEAAwYGEm56dxIWakEAAwYGEhsHGgYGExRuQwQBAgQWBxwFDxESFhZoRwQDBAAWFgQcBgYHCxZqQQADBgZuWGpBAAMHV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEAAmpabkMEAQIEFhQSFg8UbkMEAQIEFmx+bxYUbkMEAQIEFhkHGAUFFxZqQQADBgYSBxgDCxMWFBJqQwYHBgQUHwYYBAAFABRuQwQBAgRqWm5DBAEDVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMEAG5YakEAAwYGEhYWBQIWakEAAwYGEm56chIWakEAAwYGEhsDGgIGExRuQwQBAgQWBBwBAhESFhZoRwQDBAAWGwQcBgQDARZqQQADBgZuWGpBAAMHV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMFV25DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEBVWpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAECBmpBAAMGBG5DBAEAAmpabkMEAQIEFhQSBwcUbkMEAQIEFmx+fRYUbkMEAQIEFhkGGAYCFxZqQQADBgYSGwcaBgITFBJqQwYHBgQUHwYYBAEFAxRuQwQBAgRqWm5DBAEHDmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAA25DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEEAWpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAA25DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMAA25DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDBG5DBAEHBmpBAAMDVm5YalpuQwMGBlJqQQZTBg1uQwMAAlJqQVRQB1VuQw8BVlVqQQRVUwxuQwMHBgZqQQcBUlISHnBbUUNFFHNEU1UbalhoRwNQDFFqQwBXBg9oRwMCBFZqQ1JUB1doRw8GA1RqQwEDAlIbbkMPUVYHakEHAgZQbkMDAVNTFhxzQFldVhl0WFNVXVhbRUIdblhqWm5DDwwDDmpBBwcCDG5DAAMFUGpBBw4CVW5DAwQCVGpBCgZXBW5DAVZXD2pBCwYBDBIeYltCFmVRUUJZRhJlQltRXRZnUURTUVwfalpuQwFWVw9qQQsGAQxuQwBVAw9qQQRTDwIIFmpBBwZQDW5DAAwBVRYKEgMGcX93FhISBAdxf3cWHG5DDlBTDmpBBwRTBhsaFmhHAFVRAGpDAQBSA2hHAAMHBGpDA1cEUxQadVldXl9YUxtqWAkPCwsJDwsLCQ8LCwkPCwsJDwsLCQ8LCwkPCwsJDwsLCQ8LCwkPCwsJDwsLCQ8LCwkPCwsJDwsLCQ8LC2hcalhoRwABA1RqQwEKAlcOEm56cW5YYl1RXVNGEhYWFGZEU1pWFhYUEmBZWBIWFhQSYFlYEhNqWh8bGxkfGxsZEhYbGR8bGxkfFhYZHxsbGR8WFhkfGxsZHxtqWmp5exQSFhYUEhZ5FBIWFhQSFhZ6XURbVV4WFgYcBA8Rblh1YmoWFhQSFhYUfRYWFBIWFhQSeFlGX1daFBIHGAIDE2pacXlmFBIWFhQSFnkUEhYWFBIWFnpdRFtVXhYWBhwGABFuWHN7dRYWFBIWFhR9FhYUEhYWFBJ4WUZfV1oUEgQYAAoTalphenQUEhYWFBIWeRQSFhYUEhYWel1EW1VeFhYGHAMFEW5Ye2RxFhYUEhYWFH0WFhQSFhYUEnhZRl9XWhQSBRgGBxNqWmJlbhQSFhYUEhZ5FBIWFhQSFhZ6XURbVV4WFgYcAAQRblhgeH0WFhQSFhYUfRYWFBIWFhQSeFlGX1daFBIEGAwCE2pafW5vFBIWFhQSFnkUEhYWFBIWFnpdRFtVXhYWBhwDBBFuWGF5cBYWFBIWFhR9FhYUEhYWFBJ4WUZfV1oUEgQYAwATalpuWGpBBAEBUm5DAwwGVwwUanp0aFxiX1dZU0QUEhYWYEBTWFASFhYUZFlaFBIWFhRkWVoUF2pYGR8bGxkfGxsUEhsbGR8bGxkSFhsZHxsbGRIWGxkfGxsZH2pYeHt4FhQSFhYUEnkWFBIWFhQSFnhbQFtXWBIWBBoHBRNoXGV+YxIWFhQSFhZ7EhYWFBIWFhR8WURZU1oWFAMYDgcXalhycW4WFBIWFhQSeRYUEhYWFBIWeFtAW1dYEhYCGgQDE2hcd2ZwEhYWFBIWFnsSFhYUEhYWFHxZRFlTWhYUABgAAhdqWHFxehYUEhYWFBJ5FhQSFhYUEhZ4W0BbV1gSFgQaBQYTaFx4c3kSFhYUEhYWexIWFhQSFhYUfFlEWVNaFhQGGAQFF2pYcH1hFhQSFhYUEnkWFBIWFhQSFnhbQFtXWBIWAhoHDxNoXHViYnMWFhQSFhZ7EhYWFBIWFhR8WURZU1oWFAAYBwwXalhkYnEWFBIWFhQSeRYUEhYWFBIWeFtAW1dYEhYHGgsCE2hcalhoRwABA1RqQwEKAlcOEm56ZG5YYl1RXVNGEhYWFGZEU1pWFhYUEmBZWBIWFhQSYFlYEhNqWh8bGxkfGxsZEhYbGR8bGxkfFhYZHxsbGR8WFhkfGxsZHxtqWmJxFhQSFhYUEhZ5FBIWFhQSFhZ6XURbVV4WFgYcBgYRblh1e2FiFhQSFhYUfRYWFBIWFhQSeFlGX1daFBIEGAEKE2paYnNmFBIWFhQSFnkUEhYWFBIWFnpdRFtVXhYWBhwCBxFuWGF5ZhYWFBIWFhR9FhYUEhYWFBJ4WUZfV1oUEgQYAwETalp5eRYUEhYWFBIWeRQSFhYUEhYWel1EW1VeFhYGHAcDEW5YZnkSFhYUEhYWFH0WFhQSFhYUEnhZRl9XWhQSBBgBBRNqWn9yem4SFhYUEhZ5FBIWFhQSFhZ6XURbVV4WFgYcAgYRblh1eBIWFhQSFhYUfRYWFBIWFhQSeFlGX1daFBIEGAQCE2paf3kWFBIWFhQSFnkUEhYWFBIWFnpdRFtVXhYWBhwDARFuWGJzZhYWFBIWFhR9FhYUEhYWFBJ4WUZfV1oUEgQYDQoTFEk=</div>

    <script>
        function unlock() {
            const pin = document.getElementById('pin-input').value;
            const encryptedData = document.getElementById('encrypted-data').innerText;
            const errorMsg = document.getElementById('error-msg');
            
            try {
                const decryptedJSON = simple_decrypt(encryptedData, pin);
                const data = JSON.parse(decryptedJSON);
                
                // If parse successful, show content
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                
                // Set session storage for detail pages
                sessionStorage.setItem('unlocked', 'true');
                
                // Populate Raw Report
                document.getElementById('raw-report').innerText = data.report_text;
                
                // Populate Table
                const tableBody = document.querySelector('#sector-table tbody');
                data.sectors.forEach(sector => {
                    const tr = document.createElement('tr');
                    
                    const p4Class = sector.perf_4w >= 0 ? 'metric-pos' : 'metric-neg';
                    const p12Class = sector.perf_12w >= 0 ? 'metric-pos' : 'metric-neg';
                    const scoreClass = sector.score > 0 ? 'metric-pos' : 'metric-neg';
                    
                    tr.innerHTML = `
                        <td>${sector.rank}</td>
                        <td><a href="pages/${sector.ticker}.html">${sector.ticker}</a></td>
                        <td>${sector.name}</td>
                        <td class="${p4Class}">${(sector.perf_4w * 100).toFixed(2)}%</td>
                        <td class="${p12Class}">${(sector.perf_12w * 100).toFixed(2)}%</td>
                        <td class="${scoreClass}"><strong>${sector.score.toFixed(4)}</strong></td>
                    `;
                    tableBody.appendChild(tr);
                });
                
                // Initialize DataTables
                $('#sector-table').DataTable({
                    paging: false,
                    searching: true,
                    info: false,
                    order: [[ 0, "asc" ]] // Sort by Rank by default
                });
                
                errorMsg.style.display = 'none';
                
            } catch (e) {
                errorMsg.style.display = 'block';
                console.error(e);
            }
        }

        function simple_decrypt(base64Text, pin) {
            const encryptedBytes = Uint8Array.from(atob(base64Text), c => c.charCodeAt(0));
            const encoder = new TextEncoder();
            const pinBytes = encoder.encode(pin);
            const keyBytes = new Uint8Array(encryptedBytes.length);
            
            for (let i = 0; i < encryptedBytes.length; i++) {
                keyBytes[i] = pinBytes[i % pinBytes.length];
            }
            
            const decryptedBytes = new Uint8Array(encryptedBytes.length);
            for (let i = 0; i < encryptedBytes.length; i++) {
                decryptedBytes[i] = encryptedBytes[i] ^ keyBytes[i];
            }
            
            const decoder = new TextDecoder();
            return decoder.decode(decryptedBytes);
        }
        
        // Auto-login via session
        if (sessionStorage.getItem('unlocked')) {
             // We can't auto-decrypt because we don't store the PIN in session for security (or maybe we could?)
             // Actually, if we want auto-show, we'd need the PIN. 
             // Let's just focus on the 'Enter PIN' UX for now, it's safer.
             // But we authorize detail pages if this main page was unlocked once? 
             // The detail pages check sessionStorage. 
             // But to view THIS page again, you need to decrypt data again.
             // Unless we store the DECRYPTED key or PIN in sessionStorage.
             // Let's store the PIN in sessionStorage temporarily for convenience.
             const storedPin = sessionStorage.getItem('session_pin');
             if (storedPin) {
                 document.getElementById('pin-input').value = storedPin;
                 // Ideally trigger unlock automatically, but we need the DOM to be ready.
                 // We'll let user click or hit enter, prepopulating is helpful enough.
             }
        }
        
        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                unlock();
                sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
            }
        });
        
        // Also save pin on click
        document.querySelector('button').addEventListener('click', function() {
             sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
        });
    </script>
</body>
</html>
    