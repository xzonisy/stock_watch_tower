
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watch Tower - ÊØèÈÄ±ÊùøÂ°äÁõ£Ê∏¨ report</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #e0e0e0; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #2d2d2d; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #4caf50; }
        
        /* Login Area */
        #login-area { text-align: center; margin-top: 50px; }
        input { padding: 10px; font-size: 1.2rem; border-radius: 5px; border: 1px solid #444; background: #333; color: white; width: 150px; text-align: center; }
        button { padding: 10px 20px; font-size: 1.2rem; border-radius: 5px; border: none; background-color: #4caf50; color: white; cursor: pointer; margin-left: 10px; }
        button:hover { background-color: #45a049; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
        
        /* Content Area */
        #content-area { display: none; }
        
        /* Table Styles */
        .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table.dataTable tbody tr { background-color: #2d2d2d; color: #e0e0e0; }
        table.dataTable tbody tr:hover { background-color: #383838; }
        table.dataTable thead th { border-bottom: 1px solid #444; color: #4caf50; }
        table.dataTable td { border-bottom: 1px solid #444; }
        
        /* Links */
        a { color: #64b5f6; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        
        /* Utilities */
        .hidden-data { display: none; }
        .metric-pos { color: #ff5252; }
        .metric-neg { color: #81c784; }
        
        /* Chart container */
        .chart-container { position: relative; height: 400px; width: 100%; margin-bottom: 30px; }
    </style>
    
    <!-- jQuery & DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîê ÊØèÈÄ±ÊùøÂ°äËº™ÂãïÁõ£Ê∏¨</h1>
        
        <div id="login-area">
            <p>Ë´ãËº∏ÂÖ• 4 ‰ΩçÊï∏ PIN Á¢º‰ª•Ëß£ÈéñÂ†±Âëä„ÄÇ</p>
            <input type="password" id="pin-input" maxlength="4" placeholder="PIN" inputmode="numeric" pattern="[0-9]*" autofocus>
            <button onclick="unlock()">Ëß£Èéñ</button>
            <p class="error" id="error-msg">PIN Á¢ºÈåØË™§</p>
        </div>

        <div id="content-area">
            <h3>üìä ÊùøÂ°äË°®ÁèæÊ¶ÇË¶Ω (Sector Performance)</h3>
            <div class="chart-container">
                <canvas id="perfChart"></canvas>
            </div>
            
            <h3>üìã ÊùøÂ°äËº™ÂãïÊéíÂêç (Rotation Ranking)</h3>
            <div class="table-container">
                <table id="sector-table" class="display" style="width:100%">
                    <thead>
                        <tr>
                            <th>ÊéíÂêç</th>
                            <th>‰ª£Á¢º</th>
                            <th>ÂêçÁ®±</th>
                            <th>4ÈÄ±Ë°®Áèæ</th>
                            <th>12ÈÄ±Ë°®Áèæ</th>
                            <th>RS ÂàÜÊï∏</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <hr style="margin: 30px 0; border-color: #444;">
            
            <h3>üìù ÂÆåÊï¥ÊñáÂ≠óÂ†±Âëä (Detailed Report)</h3>
            <pre id="raw-report" style="background: #111; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas;"></pre>
        </div>
    </div>
    
    <div id="encrypted-data" class="hidden-data">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VltXEA0WEG5CDwNWBmpHCgAOVm5CDgJTBhYadF5YU1xUX1NeHhQeEhVGV0BRaQZFFQwSHwcYAgADAwIGBQMFAgQFCgAHDwEFGxYQQlJEVG0GBEUQDRYCHAcEAQsGAgYBAA4KAwcAAwcOAx4SFUVRXUVTEAgXGwIcBwQHBAIDAwACDwIKBAQCBQFLbx4XFEBXR1lARmhCV0pDFAgSFWpHBFVVVG5CDwIBBmpHBAABVG5CAwoGVmpHClEEU25CAwBWAmpHBQFTAW5CAFcAVGpcDwoLDw8KCw8PCgsPDwoLDw8KCw8PCgsPDwoLDw8KCw8PCgsPDwoLD25ZakcAAgMAbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwQDakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgAGbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwQDakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwQDakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcCalxuQgQHAgUWEhJrQwQBDgRuRwICAlYXakcAAgYAEmtDBAUAUG5HAg4GUxcWEm5CBAcCBRYGbkIPAgEGakcKDwAKbkIBAVRSFhISa0MABwcEEgMFakcLBwUDbkIOCgQPakcFBFBXEhcWbkcFAwIAFxYSEmVlbkcCBAIEa0MEBwAOEm5CBAcCBWpcbkIEBwdSakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgBTbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwRWakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgBTbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgBTbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgADbllqRwACBgASFxYSAxdqRwACBgASb3p3EhdqRwACBgASBgUcAw4TEm5CBAcCBRYABxkEBxcXFm5HBQMCABcWAhwGAAQLF2pHAAIGAG5ZakcAAgdRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwADalxuQgQHAgUWEhIXBBJuQgQHAgUWan51FhJuQgQHAgUWBRwFDxcSF2pHAAIGABIFAxwFAhMSEmtDAAcHBBISBxgDAQ4OEm5CBAcCBWpcbkIEBwNUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgQGbllqRwACBgASFxYSARdqRwACBgASb3p7EhdqRwACBgASARgCAhIWEm5CBAcCBRYDCxkACxcXFm5HBQMCABcWAhwGBgEDF2pHAAIGAG5ZakcAAgdRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwADalxuQgQHAgUWEhIXAhJuQgQHAgUWan5nFhJuQgQHAgUWBBwEAhcSF2pHAAIGABIGAhwEDxMSEmtDAAcHBBISBxgCBQ4OEm5CBAcCBWpcbkIEBwNUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgQGbllqRwACBgASFxYSBxdqRwACBgASb3pnEhdqRwACBgASABgDChIWEm5CBAcCBRYHHAIAFxIXFm5HBQMCABcWAhwHBQoBF2pHAAIGAG5ZakcAAgdRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwADalxuQgQHAgUWEhIXABJuQgQHAgUWan5lcxJuQgQHAgUWARwOARcSF2pHAAIGABIPGAMKEhYSEmtDAAcHBBISBxgCAQICEm5CBAcCBWpcbkIEBwNUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgQGbllqRwACBgASFxYSBRdqRwACBgASb3pxEhdqRwACBgASBxgGBhIWEm5CBAcCBRYHHAcCFxIXFm5HBQMCABcWAhwHBgADF2pHAAIGAG5ZakcAAgdRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwADalxuQgQHAgUWEhIXDhJuQgQHAgUWan5hFhJuQgQHAgUWHwIZAAEXF2pHAAIGABIDGAECEhYSEmtDAAcHBBIfBxgCAgAWEm5CBAcCBWpcbkIEBwNUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgQGbllqRwACBgASFxYSCxdqRwACBgASb3prEhdqRwACBgASGgIcAAITEm5CBAcCBRYHHAQFFxIXFm5HBQMCABcbAhwHBBISF2pHAAIGAG5ZakcAAgdRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwADalxuQgQHAgUWEhIGBhJuQgQHAgUWan58FhJuQgQHAgUWHwAZAwIXF2pHAAIGABIEGAACEhYSEmtDAAcHBBIfBxgCAAYPEm5CBAcCBWpcbkIEBwNUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwFUakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgVRbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgYCbkIEBwIHakcAAgQGbllqRwACBgASFxYDAxdqRwACBgASb3p0EhdqRwACBgASGgQcBgITEm5CBAcCBRYAHAQPFxIXFm5HBQMCABcbAhwHBAcFF2pHAAIGAG5ZakcAAgMKbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwQAakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgAFbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwQAakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwQAakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwcHakcAAgMCbkIEBwdValxuWWpHBwUCVm5CAlcCDmpHBwMGVm5CUFQDVmpHCwJSUW5CAFFXD2pHBwQCAm5CAwVWURYadFhVR0EXd0BXVh9uXGtDB1QPVW5HA1MCC2tDBwYHUm5HUVADU2tDCwIAUG5HAgcGVhhqRwtSUgNuQgMGAlNqRwcCV1cSH3dEXV5SHXBbV1FZW19BRh5qXG5ZakcLDwcKbkIDAwYPakcEAAFUbkIDCgZWakcHBwZQbkIOAlMGakcFVVMLbkIPAgUPFhpmWEYSYVJVRl1FFmFGWFVZEmRVQFdSWBtuWWpHBVVTC25CDwIFD2pHBFYHC25CAFcLAQwSbkIDAlQOakcEDwVREgkWBwJye3MSERYAA3J7cxIfakcKU1cKbkIDAFcFHx4Sa0MEUVIEbkcCBFYHa0MEBwQAbkcAUwBXFx5xXV5aW1xQH25cCgsPDwoLDw8KCw8PCgsPDwoLDw8KCw8PCgsPDwoLDw8KCw8PCgsPDwoLDw8KCw8PCgsPDwoLDw8KCw8Pa1huXGtDBAUAUG5HAg4GUw0Wan5yalxmXlVZV0UWEhIXYkBXWVISEhcWZF1bFhISFxZkXVsWF25ZGx8fGhsfHxoWEh8aGx8fGhsSEhobHx8aGxISGhsfHxobH25Zbn1/FxYSEhcWEn0XFhISFxYSEnlZQF9WWhISBRgHBhJqXHFhbhISFxYSEhd5EhIXFhISFxZ8XUVbU14XFgMcDwAXbll1fWIXFhISFxYSfRcWEhIXFhISeVlAX1ZaEhIFGAQKEmpcd3hxEhIXFhISF3kSEhcWEhIXFnxdRVtTXhcWABwPAhduWWV+cBcWEhIXFhJ9FxYSEhcWEhJ5WUBfVloSEgQYAgMSalx/Z3USEhcWEhIXeRISFxYSEhcWfF1FW1NeFxYGHAcHF25ZZmFqFxYSEhcWEn0XFhISFxYSEnlZQF9WWhISBBgBAxJqXGR7eRISFxYSEhd5EhIXFhISFxZ8XUVbU14XFgEcBAMXbll5amsXFhISFxYSfRcWEhIXFhISeVlAX1ZaEhIEGAUHEmpcZXp0EhIXFhISF3kSEhcWEhIXFmZbUF5GEhcWAxwOAhduWWpcbkIABQVRakcHDwJTCBdufnBrWGZbVF1XQBcWEhJjRFdcUxYSEhdgXV4XFhISF2BdXhcTblwaGx8fGhsfHxcWHx8aGx8fGhYSHxobHx8aFhIfGhsfHxobblx7f3wSFxYSEhcWfRIXFhISFxYSfFhEX1NbFhIDGQELF2tYdHFvFhISFxYSEngWEhIXFhISF3hdQFpXXhIXAhwEBRNuXHZmdhIXFhISFxZ9EhcWEhIXFhJ8WERfU1sWEgAZBQEXa1h3cXsWEhIXFhISeBYSEhcWEhIXeF1AWldeEhcHHAUBE25ceXN/EhcWEhIXFn0SFxYSEhcWEnxYRF9TWxYSBhkABxdrWHZ9YBYSEhcWEhJ4FhISFxYSEhd4XUBaV14SFwIcAAATblx0YmRzFxYSEhcWfRIXFhISFxYSfFhEX1NbFhIDGQEHF2tYc351FhISFxYSEngWEhIXFhISF3hdQFpXXhIXABwBDxNuXGdmdRIXFhISFxZ9EhcWEhIXFhJ8WERfU1sWEgAZAwMXa1huXGtDBAUAUG5HAg4GUw0Wan5+alxmXlVZV0UWEhIXYkBXWVISEhcWZF1bFhISFxZkXVsWF25ZGx8fGhsfHxoWEh8aGx8fGhsSEhobHx8aGxISGhsfHxobH25ZcXcSFxYSEhcWEn0XFhISFxYSEnlZQF9WWhISBBgHCxJqXHF2YhISFxYSEhd5EhIXFhISFxZ8XUVbU14XFgEcAgIXblljfGIXFhISFxYSfRcWEhIXFhISeVlAX1ZaEhIGGAUCEmpcenh4EhIXFhISF3kSEhcWEhIXFnxdRVtTXhcWAxwOAhduWWRmahcWEhIXFhJ9FxYSEhcWEhJ5WUBfVloSEgUYBgsSalx2chYSEhcWEhIXeRISFxYSEhcWfF1FW1NeFxYBHAAEF25Zen9mFxYSEhcWEn0XFhISFxYSEmNfVVpDFhISBRgABxIUTw==</div>

    <script>
        function unlock() {
            const pin = document.getElementById('pin-input').value;
            const encryptedData = document.getElementById('encrypted-data').innerText;
            const errorMsg = document.getElementById('error-msg');
            
            try {
                const decryptedJSON = simple_decrypt(encryptedData, pin);
                const data = JSON.parse(decryptedJSON);
                
                // If parse successful, show content
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                
                // Set session storage for detail pages
                sessionStorage.setItem('unlocked', 'true');
                
                // Populate Raw Report
                document.getElementById('raw-report').innerText = data.report_text;
                
                // Populate Table
                const tableBody = document.querySelector('#sector-table tbody');
                data.sectors.forEach(sector => {
                    const tr = document.createElement('tr');
                    
                    const p4Class = sector.perf_4w >= 0 ? 'metric-pos' : 'metric-neg';
                    const p12Class = sector.perf_12w >= 0 ? 'metric-pos' : 'metric-neg';
                    const scoreClass = sector.score > 0 ? 'metric-pos' : 'metric-neg';
                    
                    tr.innerHTML = `
                        <td>${sector.rank}</td>
                        <td><a href="pages/${sector.ticker}.html">${sector.ticker}</a></td>
                        <td>${sector.name}</td>
                        <td class="${p4Class}">${(sector.perf_4w * 100).toFixed(2)}%</td>
                        <td class="${p12Class}">${(sector.perf_12w * 100).toFixed(2)}%</td>
                        <td class="${scoreClass}"><strong>${sector.score.toFixed(4)}</strong></td>
                    `;
                    tableBody.appendChild(tr);
                });
                
                // Initialize DataTables
                $('#sector-table').DataTable({
                    paging: false,
                    searching: true,
                    info: false,
                    order: [[ 0, "asc" ]] // Sort by Rank by default
                });
                
                // Render Chart
                renderChart(data.sectors);
                
                errorMsg.style.display = 'none';
                
            } catch (e) {
                errorMsg.style.display = 'block';
                console.error(e);
            }
        }

        function simple_decrypt(base64Text, pin) {
            const encryptedBytes = Uint8Array.from(atob(base64Text), c => c.charCodeAt(0));
            const encoder = new TextEncoder();
            const pinBytes = encoder.encode(pin);
            const keyBytes = new Uint8Array(encryptedBytes.length);
            
            for (let i = 0; i < encryptedBytes.length; i++) {
                keyBytes[i] = pinBytes[i % pinBytes.length];
            }
            
            const decryptedBytes = new Uint8Array(encryptedBytes.length);
            for (let i = 0; i < encryptedBytes.length; i++) {
                decryptedBytes[i] = encryptedBytes[i] ^ keyBytes[i];
            }
            
            const decoder = new TextDecoder();
            return decoder.decode(decryptedBytes);
        }
        
        function renderChart(sectors) {
            // Sort by RS Score descending for chart visual
            // const sortedSectors = [...sectors].sort((a, b) => b.score - a.score); # Already sorted by rank
            const tags = sectors.map(s => s.ticker);
            const perf4w = sectors.map(s => s.perf_4w * 100);
            const perf12w = sectors.map(s => s.perf_12w * 100);
            
            const ctx = document.getElementById('perfChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: tags,
                    datasets: [
                        {
                            label: '4ÈÄ±Ë°®Áèæ %',
                            data: perf4w,
                            backgroundColor: 'rgba(255, 82, 82, 0.7)',
                            borderColor: 'rgba(255, 82, 82, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '12ÈÄ±Ë°®Áèæ %',
                            data: perf12w,
                            backgroundColor: 'rgba(76, 175, 80, 0.7)',
                            borderColor: 'rgba(76, 175, 80, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#444' },
                            ticks: { color: '#e0e0e0' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#e0e0e0' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#e0e0e0' }
                        }
                    }
                }
            });
        }
        
        // Auto-login via session
        if (sessionStorage.getItem('unlocked')) {
             const storedPin = sessionStorage.getItem('session_pin');
             if (storedPin) {
                 document.getElementById('pin-input').value = storedPin;
             }
        }
        
        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                unlock();
                sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
            }
        });
        
        // Also save pin on click
        document.querySelector('button').addEventListener('click', function() {
             sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
        });
    </script>
</body>
</html>
    