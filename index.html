
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watch Tower - ÊØèÈÄ±ÊùøÂ°äÁõ£Ê∏¨ report</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #e0e0e0; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #2d2d2d; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #4caf50; }
        
        /* Login Area */
        #login-area { text-align: center; margin-top: 50px; }
        input { padding: 10px; font-size: 1.2rem; border-radius: 5px; border: 1px solid #444; background: #333; color: white; width: 150px; text-align: center; }
        button { padding: 10px 20px; font-size: 1.2rem; border-radius: 5px; border: none; background-color: #4caf50; color: white; cursor: pointer; margin-left: 10px; }
        button:hover { background-color: #45a049; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
        
        /* Content Area */
        #content-area { display: none; }
        
        /* Table Styles */
        .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table.dataTable tbody tr { background-color: #2d2d2d; color: #e0e0e0; }
        table.dataTable tbody tr:hover { background-color: #383838; }
        table.dataTable thead th { border-bottom: 1px solid #444; color: #4caf50; }
        table.dataTable td { border-bottom: 1px solid #444; }
        
        /* Links */
        a { color: #64b5f6; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        
        /* Utilities */
        .hidden-data { display: none; }
        .metric-pos { color: #ff5252; }
        .metric-neg { color: #81c784; }
        
        /* Chart container */
        .chart-container { position: relative; height: 400px; width: 100%; margin-bottom: 30px; }
    </style>
    
    <!-- jQuery & DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîê ÊØèÈÄ±ÊùøÂ°äËº™ÂãïÁõ£Ê∏¨</h1>
        
        <div id="login-area">
            <p>Ë´ãËº∏ÂÖ• 4 ‰ΩçÊï∏ PIN Á¢º‰ª•Ëß£ÈéñÂ†±Âëä„ÄÇ</p>
            <input type="password" id="pin-input" maxlength="4" placeholder="PIN" inputmode="numeric" pattern="[0-9]*" autofocus>
            <button onclick="unlock()">Ëß£Èéñ</button>
            <p class="error" id="error-msg">PIN Á¢ºÈåØË™§</p>
        </div>

        <div id="content-area">
            <h3>üìä ÊùøÂ°äË°®ÁèæÊ¶ÇË¶Ω (Sector Performance)</h3>
            <div class="chart-container">
                <canvas id="perfChart"></canvas>
            </div>
            
            <h3>üìã ÊùøÂ°äËº™ÂãïÊéíÂêç (Rotation Ranking)</h3>
            <div class="table-container">
                <table id="sector-table" class="display" style="width:100%">
                    <thead>
                        <tr>
                            <th>ÊéíÂêç</th>
                            <th>‰ª£Á¢º</th>
                            <th>ÂêçÁ®±</th>
                            <th>4ÈÄ±Ë°®Áèæ</th>
                            <th>12ÈÄ±Ë°®Áèæ</th>
                            <th>RS ÂàÜÊï∏</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <hr style="margin: 30px 0; border-color: #444;">
            
            <h3>üìù ÂÆåÊï¥ÊñáÂ≠óÂ†±Âëä (Detailed Report)</h3>
            <pre id="raw-report" style="background: #111; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas;"></pre>
        </div>
    </div>
    
    <div id="encrypted-data" class="hidden-data">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BmtNCgMCCGRDBQ0OB2tWZEMFDQgEFxgYFgYYZEMFDQgEF2B0cxcYZEMFDQgEFwkIGAAJHRZrTQoDBwoYBAQWDQcSGBhqQgoNBgUYGAYZCQ8HBRhkQwUNCARrVmRDBQ0JVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMFDGRYa00KAwcKGBYXGAoWa00KAwcKGG57ehgWa00KAwcKGAAZAAoTFxhkQwUNCAQXCggYAwgdFhdkTQQCCAoWFwgWBwQOChZrTQoDBwpkWGtNCgMGW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0KAmtWZEMFDQgEFxgYFgQYZEMFDQgEF2B0fxcYZEMFDQgEFw4WDgcdGBZrTQoDBwoYBwAWCwESGBhqQgoNBgUYGAYZCQoHFxhkQwUNCARrVmRDBQ0JVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMFDGRYa00KAwcKGBYXGAwWa00KAwcKGG57aBgWa00KAwcKGA8ZDQETFxhkQwUNCAQXCQwYAwsdFhdkTQQCCAoWFwgWBwUIChZrTQoDBwpkWGtNCgMGW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0KAmtWZEMFDQgEFxgYFgIYZEMFDQgEF2B0YxcYZEMFDQgEFwkIGAYNHRZrTQoDBwoYDhkODhMXGBhqQgoNBgUYGAYZCAECBRhkQwUNCARrVmRDBQ0JVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMFDGRYa00KAwcKGBYXGA4Wa00KAwcKGG57an0Wa00KAwcKGAMZAQ8TFxhkQwUNCAQXDxYOAR0YFhdkTQQCCAoWFwgWBgEBCxZrTQoDBwpkWGtNCgMGW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0KAmtWZEMFDQgEFxgYFgAYZEMFDQgEF2B0YBcYZEMFDQgEFwwWBwIdGBZrTQoDBwoYBRkOCBMXGBhqQgoNBgUYGAYZCAsODxhkQwUNCARrVmRDBQ0JVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMFDGRYa00KAwcKGBYXGAAWa00KAwcKGG57exgWa00KAwcKGBsGFgwDEhhkQwUNCAQXCxYHBR0YFhdkTQQCCAoWFwgWBgcADBZrTQoDBwpkWGtNCgMGW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0KAmtWZEMFDQgEFxgYFg4YZEMFDQgEF2B0bxcYZEMFDQgEFxULGAIPHRZrTQoDBwoYGwYWCAQSGBhqQgoNBgUYFQYZCAoEDhhkQwUNCARrVmRDBQ0JVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMFDGRYa00KAwcKGBYXCQgWa00KAwcKGG57fhgWa00KAwcKGBsEFgEAEhhkQwUNCAQXFQoYAwodFhdkTQQCCAoWGggWBgQJABZrTQoDBwpkWGtNCgMGW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMEW2RDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0LVWtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0IBmtNCgMHCGRDBQ0KAmtWZEMFDQgEFxgYBwYYZEMFDQgEF2B0fRcYZEMFDQgEFxUNGAIKHRZrTQoDBwoYGwUWAQISGBhqQgoNBgUYFQYZCAwEBRhkQwUNCARrVmRDBQ0NDmtNCgMCCGRDBQ0NBmtNCgMCCGRDBQ0NBmtNCgMCCGRDBQ0NBmtNCgMBD2RDBQ0NBmtNCgMCCGRDBQ0NBmtNCgMCCGRDBQ0NBmtNCgMCCGRDBQ0O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</div>

    <script>
        function unlock() {
            const pin = document.getElementById('pin-input').value;
            const encryptedData = document.getElementById('encrypted-data').innerText;
            const errorMsg = document.getElementById('error-msg');
            
            try {
                const decryptedJSON = simple_decrypt(encryptedData, pin);
                const data = JSON.parse(decryptedJSON);
                
                // If parse successful, show content
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                
                // Set session storage for detail pages
                sessionStorage.setItem('unlocked', 'true');
                
                // Populate Raw Report
                document.getElementById('raw-report').innerText = data.report_text;
                
                // Populate Table
                const tableBody = document.querySelector('#sector-table tbody');
                data.sectors.forEach(sector => {
                    const tr = document.createElement('tr');
                    
                    const p4Class = sector.perf_4w >= 0 ? 'metric-pos' : 'metric-neg';
                    const p12Class = sector.perf_12w >= 0 ? 'metric-pos' : 'metric-neg';
                    const scoreClass = sector.score > 0 ? 'metric-pos' : 'metric-neg';
                    
                    tr.innerHTML = `
                        <td>${sector.rank}</td>
                        <td><a href="pages/${sector.ticker}.html">${sector.ticker}</a></td>
                        <td>${sector.name}</td>
                        <td class="${p4Class}">${(sector.perf_4w * 100).toFixed(2)}%</td>
                        <td class="${p12Class}">${(sector.perf_12w * 100).toFixed(2)}%</td>
                        <td class="${scoreClass}"><strong>${sector.score.toFixed(4)}</strong></td>
                    `;
                    tableBody.appendChild(tr);
                });
                
                // Initialize DataTables
                $('#sector-table').DataTable({
                    paging: false,
                    searching: true,
                    info: false,
                    order: [[ 0, "asc" ]] // Sort by Rank by default
                });
                
                // Render Chart
                renderChart(data.sectors);
                
                errorMsg.style.display = 'none';
                
            } catch (e) {
                errorMsg.style.display = 'block';
                console.error(e);
            }
        }

        function simple_decrypt(base64Text, pin) {
            const encryptedBytes = Uint8Array.from(atob(base64Text), c => c.charCodeAt(0));
            const encoder = new TextEncoder();
            const pinBytes = encoder.encode(pin);
            const keyBytes = new Uint8Array(encryptedBytes.length);
            
            for (let i = 0; i < encryptedBytes.length; i++) {
                keyBytes[i] = pinBytes[i % pinBytes.length];
            }
            
            const decryptedBytes = new Uint8Array(encryptedBytes.length);
            for (let i = 0; i < encryptedBytes.length; i++) {
                decryptedBytes[i] = encryptedBytes[i] ^ keyBytes[i];
            }
            
            const decoder = new TextDecoder();
            return decoder.decode(decryptedBytes);
        }
        
        function renderChart(sectors) {
            // Sort by RS Score descending for chart visual
            // const sortedSectors = [...sectors].sort((a, b) => b.score - a.score); # Already sorted by rank
            const tags = sectors.map(s => s.ticker);
            const perf4w = sectors.map(s => s.perf_4w * 100);
            const perf12w = sectors.map(s => s.perf_12w * 100);
            
            const ctx = document.getElementById('perfChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: tags,
                    datasets: [
                        {
                            label: '4ÈÄ±Ë°®Áèæ %',
                            data: perf4w,
                            backgroundColor: 'rgba(255, 82, 82, 0.7)',
                            borderColor: 'rgba(255, 82, 82, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '12ÈÄ±Ë°®Áèæ %',
                            data: perf12w,
                            backgroundColor: 'rgba(76, 175, 80, 0.7)',
                            borderColor: 'rgba(76, 175, 80, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#444' },
                            ticks: { color: '#e0e0e0' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#e0e0e0' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#e0e0e0' }
                        }
                    }
                }
            });
        }
        
        // Auto-login via session
        if (sessionStorage.getItem('unlocked')) {
             const storedPin = sessionStorage.getItem('session_pin');
             if (storedPin) {
                 document.getElementById('pin-input').value = storedPin;
             }
        }
        
        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                unlock();
                sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
            }
        });
        
        // Also save pin on click
        document.querySelector('button').addEventListener('click', function() {
             sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
        });
    </script>
</body>
</html>
    