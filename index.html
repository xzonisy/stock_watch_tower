
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watch Tower - ÊØèÈÄ±ÊùøÂ°äÁõ£Ê∏¨ report</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #e0e0e0; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #2d2d2d; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #4caf50; }
        
        /* Login Area */
        #login-area { text-align: center; margin-top: 50px; }
        input { padding: 10px; font-size: 1.2rem; border-radius: 5px; border: 1px solid #444; background: #333; color: white; width: 150px; text-align: center; }
        button { padding: 10px 20px; font-size: 1.2rem; border-radius: 5px; border: none; background-color: #4caf50; color: white; cursor: pointer; margin-left: 10px; }
        button:hover { background-color: #45a049; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
        
        /* Content Area */
        #content-area { display: none; }
        
        /* Table Styles */
        .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table.dataTable tbody tr { background-color: #2d2d2d; color: #e0e0e0; }
        table.dataTable tbody tr:hover { background-color: #383838; }
        table.dataTable thead th { border-bottom: 1px solid #444; color: #4caf50; }
        table.dataTable td { border-bottom: 1px solid #444; }
        
        /* Links */
        a { color: #64b5f6; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        
        /* Utilities */
        .hidden-data { display: none; }
        .metric-pos { color: #ff5252; }
        .metric-neg { color: #81c784; }
        
        /* Chart container */
        .chart-container { position: relative; height: 400px; width: 100%; margin-bottom: 30px; }
    </style>
    
    <!-- jQuery & DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîê ÊØèÈÄ±ÊùøÂ°äËº™ÂãïÁõ£Ê∏¨</h1>
        
        <div id="login-area">
            <p>Ë´ãËº∏ÂÖ• 4 ‰ΩçÊï∏ PIN Á¢º‰ª•Ëß£ÈéñÂ†±Âëä„ÄÇ</p>
            <input type="password" id="pin-input" maxlength="4" placeholder="PIN" inputmode="numeric" pattern="[0-9]*" autofocus>
            <button onclick="unlock()">Ëß£Èéñ</button>
            <p class="error" id="error-msg">PIN Á¢ºÈåØË™§</p>
        </div>

        <div id="content-area">
            <h3>üìä ÊùøÂ°äË°®ÁèæÊ¶ÇË¶Ω (Sector Performance)</h3>
            <div class="chart-container">
                <canvas id="perfChart"></canvas>
            </div>
            
            <h3>üìã ÊùøÂ°äËº™ÂãïÊéíÂêç (Rotation Ranking)</h3>
            <div class="table-container">
                <table id="sector-table" class="display" style="width:100%">
                    <thead>
                        <tr>
                            <th>ÊéíÂêç</th>
                            <th>‰ª£Á¢º</th>
                            <th>ÂêçÁ®±</th>
                            <th>4ÈÄ±Ë°®Áèæ</th>
                            <th>12ÈÄ±Ë°®Áèæ</th>
                            <th>RS ÂàÜÊï∏</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <hr style="margin: 30px 0; border-color: #444;">
            
            <h3>üìù ÂÆåÊï¥ÊñáÂ≠óÂ†±Âëä (Detailed Report)</h3>
            <pre id="raw-report" style="background: #111; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas;"></pre>
        </div>
    </div>
    
    <div id="encrypted-data" class="hidden-data">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CGlBBg0DBWhWaUEGDQUGFBgVFAUYaUEGDQUGFGB5cRQYaUEGDQUGFAkHGgYJEBRoTQcBBAoVBgcWAg0RGBVoQQoABAYYFQQaCQABBRhpQQYNBQZoVmlBBg0EV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEGDGlaaE0HAQQKFRQUGAcUaE0HAQQKFWx4ehUUaE0HAQQKFQIaAQARFBhpQQYNBQYUCgYaBwgQFBRkQAYBCAcUFAgbBQYOBhRoTQcBBAppWmhNBwEFW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0HAGhWaUEGDQUGFBgVFAcYaUEGDQUGFGB5fRQYaUEGDQUGFA8bBA0dFRRoTQcBBAoVBQwWDQERGBVoQQoABAYYFQQaCQUADBhpQQYNBQZoVmlBBg0EV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEGDGlaaE0HAQQKFRQUGAEUaE0HAQQKFWx4aBUUaE0HAQQKFQIaAAYRFBhpQQYNBQYUCQYaAwsQFBRkQAYBCAcUFAgbBAMPDBRoTQcBBAppWmhNBwEFW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0HAGhWaUEGDQUGFBgVFAEYaUEGDQUGFGB5YRQYaUEGDQUGFAAbAAwdFRRoTQcBBAoVARoBBREUGBVoQQoABAYYFQQaCAEDFBhpQQYNBQZoVmlBBg0EV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEGDGlaaE0HAQQKFRQUGAMUaE0HAQQKFWx4anAUaE0HAQQKFQEaAA0RFBhpQQYNBQYUDxsCAx0VFBRkQAYBCAcUFAgbBAAKDRRoTQcBBAppWmhNBwEFW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0HAGhWaUEGDQUGFBgVFAMYaUEGDQUGFGB5dxQYaUEGDQUGFAgbAAMdFRRoTQcBBAoVABoPBxEUGBVoQQoABAYYFQQaCAUFFBhpQQYNBQZoVmlBBg0EV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEGDGlaaE0HAQQKFRQUGA0UaE0HAQQKFWx4bhUUaE0HAQQKFRkEFgwHERhpQQYNBQYUCRsMAh0VFBRkQAYBCAcUGQgbBAYIBhRoTQcBBAppWmhNBwEFW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0HAGhWaUEGDQUGFBgVFA0YaUEGDQUGFGB5fxQYaUEGDQUGFBUHGgMOEBRoTQcBBAoVBxoKDBEUGBVoQQoABAYYGAQaCAcGBxhpQQYNBQZoVmlBBg0EV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEGDGlaaE0HAQQKFRQUCQUUaE0HAQQKFWx4YRUUaE0HAQQKFRkAFgcGERhpQQYNBQYUDBsHAx0VFBRkQAYBCAcUGQgbBAYMBBRoTQcBBAppWmhNBwEFW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEHW2lBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0GV2hNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0FBGhNBwEECGlBBg0HAGhWaUEGDQUGFBgVBQUYaUEGDQUGFGB5chQYaUEGDQUGFBUHGgANEBRoTQcBBAoVBRoBAREUGBVoQQoABAYYGAQaCAcDARhpQQYNBQZoVmlBBg0ADGhNBwEBCGlBBg0ABGhNBwEBCGlBBg0ABGhNBwEBCGlBBg0ABGhNBwECD2lBBg0ABGhNBwEBCGlBBg0ABGhNBwEBCGlBBg0ABGhNBwEBCGlBBg0DA2hNBwEB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</div>

    <script>
        function unlock() {
            const pin = document.getElementById('pin-input').value;
            const encryptedData = document.getElementById('encrypted-data').innerText;
            const errorMsg = document.getElementById('error-msg');
            
            try {
                const decryptedJSON = simple_decrypt(encryptedData, pin);
                const data = JSON.parse(decryptedJSON);
                
                // If parse successful, show content
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                
                // Set session storage for detail pages
                sessionStorage.setItem('unlocked', 'true');
                
                // Populate Raw Report
                document.getElementById('raw-report').innerText = data.report_text;
                
                // Populate Table
                const tableBody = document.querySelector('#sector-table tbody');
                data.sectors.forEach(sector => {
                    const tr = document.createElement('tr');
                    
                    const p4Class = sector.perf_4w >= 0 ? 'metric-pos' : 'metric-neg';
                    const p12Class = sector.perf_12w >= 0 ? 'metric-pos' : 'metric-neg';
                    const scoreClass = sector.score > 0 ? 'metric-pos' : 'metric-neg';
                    
                    tr.innerHTML = `
                        <td>${sector.rank}</td>
                        <td><a href="pages/${sector.ticker}.html">${sector.ticker}</a></td>
                        <td>${sector.name}</td>
                        <td class="${p4Class}">${(sector.perf_4w * 100).toFixed(2)}%</td>
                        <td class="${p12Class}">${(sector.perf_12w * 100).toFixed(2)}%</td>
                        <td class="${scoreClass}"><strong>${sector.score.toFixed(4)}</strong></td>
                    `;
                    tableBody.appendChild(tr);
                });
                
                // Initialize DataTables
                $('#sector-table').DataTable({
                    paging: false,
                    searching: true,
                    info: false,
                    order: [[ 0, "asc" ]] // Sort by Rank by default
                });
                
                // Render Chart
                renderChart(data.sectors);
                
                errorMsg.style.display = 'none';
                
            } catch (e) {
                errorMsg.style.display = 'block';
                console.error(e);
            }
        }

        function simple_decrypt(base64Text, pin) {
            const encryptedBytes = Uint8Array.from(atob(base64Text), c => c.charCodeAt(0));
            const encoder = new TextEncoder();
            const pinBytes = encoder.encode(pin);
            const keyBytes = new Uint8Array(encryptedBytes.length);
            
            for (let i = 0; i < encryptedBytes.length; i++) {
                keyBytes[i] = pinBytes[i % pinBytes.length];
            }
            
            const decryptedBytes = new Uint8Array(encryptedBytes.length);
            for (let i = 0; i < encryptedBytes.length; i++) {
                decryptedBytes[i] = encryptedBytes[i] ^ keyBytes[i];
            }
            
            const decoder = new TextDecoder();
            return decoder.decode(decryptedBytes);
        }
        
        function renderChart(sectors) {
            // Sort by RS Score descending for chart visual
            // const sortedSectors = [...sectors].sort((a, b) => b.score - a.score); # Already sorted by rank
            const tags = sectors.map(s => s.ticker);
            const perf4w = sectors.map(s => s.perf_4w * 100);
            const perf12w = sectors.map(s => s.perf_12w * 100);
            
            const ctx = document.getElementById('perfChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: tags,
                    datasets: [
                        {
                            label: '4ÈÄ±Ë°®Áèæ %',
                            data: perf4w,
                            backgroundColor: 'rgba(255, 82, 82, 0.7)',
                            borderColor: 'rgba(255, 82, 82, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '12ÈÄ±Ë°®Áèæ %',
                            data: perf12w,
                            backgroundColor: 'rgba(76, 175, 80, 0.7)',
                            borderColor: 'rgba(76, 175, 80, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#444' },
                            ticks: { color: '#e0e0e0' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#e0e0e0' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#e0e0e0' }
                        }
                    }
                }
            });
        }
        
        // Auto-login via session
        if (sessionStorage.getItem('unlocked')) {
             const storedPin = sessionStorage.getItem('session_pin');
             if (storedPin) {
                 document.getElementById('pin-input').value = storedPin;
             }
        }
        
        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                unlock();
                sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
            }
        });
        
        // Also save pin on click
        document.querySelector('button').addEventListener('click', function() {
             sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
        });
    </script>
</body>
</html>
    