
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watch Tower - Weekly Monitor</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #e0e0e0; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #2d2d2d; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #4caf50; }
        
        /* Login Area */
        #login-area { text-align: center; margin-top: 50px; }
        input { padding: 10px; font-size: 1.2rem; border-radius: 5px; border: 1px solid #444; background: #333; color: white; width: 150px; text-align: center; }
        button { padding: 10px 20px; font-size: 1.2rem; border-radius: 5px; border: none; background-color: #4caf50; color: white; cursor: pointer; margin-left: 10px; }
        button:hover { background-color: #45a049; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
        
        /* Content Area */
        #content-area { display: none; }
        
        /* Table Styles */
        table.dataTable tbody tr { background-color: #2d2d2d; color: #e0e0e0; }
        table.dataTable tbody tr:hover { background-color: #383838; }
        table.dataTable thead th { border-bottom: 1px solid #444; color: #4caf50; }
        table.dataTable td { border-bottom: 1px solid #444; }
        
        /* Links */
        a { color: #64b5f6; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        
        /* Utilities */
        .hidden-data { display: none; }
        .metric-pos { color: #81c784; }
        .metric-neg { color: #e57373; }
    </style>
    
    <!-- jQuery & DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîê Weekly Sector Monitor</h1>
        
        <div id="login-area">
            <p>Please enter the 4-digit PIN to unlock.</p>
            <input type="password" id="pin-input" maxlength="4" placeholder="PIN" inputmode="numeric" pattern="[0-9]*" autofocus>
            <button onclick="unlock()">Unlock</button>
            <p class="error" id="error-msg">Incorrect PIN</p>
        </div>

        <div id="content-area">
            <h3>ÊùøÂ°äËº™ÂãïÊéíÂêç (Sector Rotation Ranking)</h3>
            <table id="sector-table" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Ticker</th>
                        <th>Name (Chinese)</th>
                        <th>4-Week %</th>
                        <th>12-Week %</th>
                        <th>RS Score</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            
            <hr style="margin: 30px 0; border-color: #444;">
            
            <h3>ÂÆåÊï¥Â†±Âëä (Full Report Text)</h3>
            <pre id="raw-report" style="background: #111; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas;"></pre>
        </div>
    </div>
    
    <div id="encrypted-data" class="hidden-data">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AW1CBQQEB2tEAwIBAG1Za0QDAgcDERcXEQAXa0QDAgcDEW97dBEXa0QDAgcDEQYDHwABEhFtQgUEAQUXAwAZBAQUFxdtRAUCAQMXFwEfBgAABBdrRAMCBwNtWWtEAwIGUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQDA2tfbUIFBAEFFxERFwURbUIFBAEFF2l9dRcRbUIFBAEFFwkfDw8UERdrRAMCBwMRBQIfBQUSERFrQgMEBwUREQcZAAcCAhFtQgUEAQVrX21CBQQAVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIFBW1Za0QDAgcDERcXEQIXa0QDAgcDEW97YREXa0QDAgcDEQ8ZBwYSFxFtQgUEAQUXAAYZAgIUFxdtRAUCAQMXFwEfBgUEERdrRAMCBwNtWWtEAwIGUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQDA2tfbUIFBAEFFxERFwMRbUIFBAEFF2l9fhcRbUIFBAEFFwQfBwEUERdrRAMCBwMRBgEfAAYSERFrQgMEBwUREQcZAQgODxFtQgUEAQVrX21CBQQAVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIFBW1Za0QDAgcDERcXEQQXa0QDAgcDEW97Y3QXa0QDAgcDEQMZAgMSFxFtQgUEAQUXCR8GBxQRFxdtRAUCAQMXFwEfBwIHABdrRAMCBwNtWWtEAwIGUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQDA2tfbUIFBAEFFxERFwERbUIFBAEFF2l9YhcRbUIFBAEFFwcfAQQUERdrRAMCBwMRAxkHAxIXERFrQgMEBwUREQcZAQQHBRFtQgUEAQVrX21CBQQAVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIFBW1Za0QDAgcDERcXEQYXa0QDAgcDEW97ZxEXa0QDAgcDEQcZBQQSFxFtQgUEAQUXBR8EDxQRFxdtRAUCAQMXFwEfBwYJABdrRAMCBwNtWWtEAwIGUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQDA2tfbUIFBAEFFxERFw8RbUIFBAEFF2l9dBcRbUIFBAEFFxwAGQMBFBdrRAMCBwMRBBkCCBIXERFrQgMEBwUREQcZAQEEDhFtQgUEAQVrX21CBQQAVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIFBW1Za0QDAgcDERcXEQgXa0QDAgcDEW97aBEXa0QDAgcDERoCHwIGEhFtQgUEAQUXAB8ADhQRFxdtRAUCAQMXGgEfBwUCBxdrRAMCBwNtWWtEAwIGUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQDA2tfbUIFBAEFFxERBgcRbUIFBAEFF2l9cRcRbUIFBAEFFxwEGQcBFBdrRAMCBwMRBxkGBRIXERFrQgMEBwURHAcZAQMABBFtQgUEAQVrX21CBQQAVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQCVGtEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIEUm1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIHAW1CBQQBB2tEAwIFBW1Za0QDAgcDERcXAAAXa0QDAgcDEW97ehEXa0QDAgcDERoDHwEBEhFtQgUEAQUXHAAZAwUUFxdtRAUCAQMXGgEfBwQCBBdrRAMCBwNtWWtEAwICCW1CBQQEB2tEAwICAW1CBQQEB2tEAwICAW1CBQQEB2tEAwICAW1CBQQHAGtEAwICAW1CBQQEB2tEAwICAW1CBQQEB2tEAwICAW1CBQQEB2tEAwIB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</div>

    <script>
        function unlock() {
            const pin = document.getElementById('pin-input').value;
            const encryptedData = document.getElementById('encrypted-data').innerText;
            const errorMsg = document.getElementById('error-msg');
            
            try {
                const decryptedJSON = simple_decrypt(encryptedData, pin);
                const data = JSON.parse(decryptedJSON);
                
                // If parse successful, show content
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                
                // Set session storage for detail pages
                sessionStorage.setItem('unlocked', 'true');
                
                // Populate Raw Report
                document.getElementById('raw-report').innerText = data.report_text;
                
                // Populate Table
                const tableBody = document.querySelector('#sector-table tbody');
                data.sectors.forEach(sector => {
                    const tr = document.createElement('tr');
                    
                    const p4Class = sector.perf_4w >= 0 ? 'metric-pos' : 'metric-neg';
                    const p12Class = sector.perf_12w >= 0 ? 'metric-pos' : 'metric-neg';
                    const scoreClass = sector.score > 0 ? 'metric-pos' : 'metric-neg';
                    
                    tr.innerHTML = `
                        <td>${sector.rank}</td>
                        <td><a href="pages/${sector.ticker}.html">${sector.ticker}</a></td>
                        <td>${sector.name}</td>
                        <td class="${p4Class}">${(sector.perf_4w * 100).toFixed(2)}%</td>
                        <td class="${p12Class}">${(sector.perf_12w * 100).toFixed(2)}%</td>
                        <td class="${scoreClass}"><strong>${sector.score.toFixed(4)}</strong></td>
                    `;
                    tableBody.appendChild(tr);
                });
                
                // Initialize DataTables
                $('#sector-table').DataTable({
                    paging: false,
                    searching: true,
                    info: false,
                    order: [[ 0, "asc" ]] // Sort by Rank by default
                });
                
                errorMsg.style.display = 'none';
                
            } catch (e) {
                errorMsg.style.display = 'block';
                console.error(e);
            }
        }

        function simple_decrypt(base64Text, pin) {
            const encryptedBytes = Uint8Array.from(atob(base64Text), c => c.charCodeAt(0));
            const encoder = new TextEncoder();
            const pinBytes = encoder.encode(pin);
            const keyBytes = new Uint8Array(encryptedBytes.length);
            
            for (let i = 0; i < encryptedBytes.length; i++) {
                keyBytes[i] = pinBytes[i % pinBytes.length];
            }
            
            const decryptedBytes = new Uint8Array(encryptedBytes.length);
            for (let i = 0; i < encryptedBytes.length; i++) {
                decryptedBytes[i] = encryptedBytes[i] ^ keyBytes[i];
            }
            
            const decoder = new TextDecoder();
            return decoder.decode(decryptedBytes);
        }
        
        // Auto-login via session
        if (sessionStorage.getItem('unlocked')) {
             // We can't auto-decrypt because we don't store the PIN in session for security (or maybe we could?)
             // Actually, if we want auto-show, we'd need the PIN. 
             // Let's just focus on the 'Enter PIN' UX for now, it's safer.
             // But we authorize detail pages if this main page was unlocked once? 
             // The detail pages check sessionStorage. 
             // But to view THIS page again, you need to decrypt data again.
             // Unless we store the DECRYPTED key or PIN in sessionStorage.
             // Let's store the PIN in sessionStorage temporarily for convenience.
             const storedPin = sessionStorage.getItem('session_pin');
             if (storedPin) {
                 document.getElementById('pin-input').value = storedPin;
                 // Ideally trigger unlock automatically, but we need the DOM to be ready.
                 // We'll let user click or hit enter, prepopulating is helpful enough.
             }
        }
        
        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                unlock();
                sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
            }
        });
        
        // Also save pin on click
        document.querySelector('button').addEventListener('click', function() {
             sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
        });
    </script>
</body>
</html>
    