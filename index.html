
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Watch Tower - Weekly Monitor</title>
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #1e1e1e; color: #e0e0e0; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #2d2d2d; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #4caf50; }
        
        /* Login Area */
        #login-area { text-align: center; margin-top: 50px; }
        input { padding: 10px; font-size: 1.2rem; border-radius: 5px; border: 1px solid #444; background: #333; color: white; width: 150px; text-align: center; }
        button { padding: 10px 20px; font-size: 1.2rem; border-radius: 5px; border: none; background-color: #4caf50; color: white; cursor: pointer; margin-left: 10px; }
        button:hover { background-color: #45a049; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
        
        /* Content Area */
        #content-area { display: none; }
        
        /* Table Styles */
        table.dataTable tbody tr { background-color: #2d2d2d; color: #e0e0e0; }
        table.dataTable tbody tr:hover { background-color: #383838; }
        table.dataTable thead th { border-bottom: 1px solid #444; color: #4caf50; }
        table.dataTable td { border-bottom: 1px solid #444; }
        
        /* Links */
        a { color: #64b5f6; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
        
        /* Utilities */
        .hidden-data { display: none; }
        .metric-pos { color: #81c784; }
        .metric-neg { color: #e57373; }
    </style>
    
    <!-- jQuery & DataTables JS -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>üîê Weekly Sector Monitor</h1>
        
        <div id="login-area">
            <p>Please enter the 4-digit PIN to unlock.</p>
            <input type="password" id="pin-input" maxlength="4" placeholder="PIN" inputmode="numeric" pattern="[0-9]*" autofocus>
            <button onclick="unlock()">Unlock</button>
            <p class="error" id="error-msg">Incorrect PIN</p>
        </div>

        <div id="content-area">
            <h3>ÊùøÂ°äËº™ÂãïÊéíÂêç (Sector Rotation Ranking)</h3>
            <table id="sector-table" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Ticker</th>
                        <th>Name (Chinese)</th>
                        <th>4-Week %</th>
                        <th>12-Week %</th>
                        <th>RS Score</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            
            <hr style="margin: 30px 0; border-color: #444;">
            
            <h3>ÂÆåÊï¥Â†±Âëä (Full Report Text)</h3>
            <pre id="raw-report" style="background: #111; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas;"></pre>
        </div>
    </div>
    
    <div id="encrypted-data" class="hidden-data">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EQsUFG9EAw9XAGhDBQMMBm9EDAZSABQeZ1RXXl1eWFlUSB0UHxEWRlZDUmkHRhYMExwEGAMFBAMFAAQCAwEHBwEIBw4ABBgWEUFRRFVuBQREEw4WHgEaBgIFAAIAAAIGCgQGAQACDQ4fERZFUF5GUxELFBsDHwQFAAQFAAcEAQ8HAQQBCgcDS24dFBRBVERZQUVrQlZJQBQJERZqRgdWVVVtQQ8DAgVqRgcDAVVtQQMLBVVqRglSBFJtQQMBVQFqRgYCUwBtQQBWA1dqXQwJCw4MCQsODAkLDgwJCw4MCQsODAkLDgwJCw4MCQsODAkLDgwJCw5tWmpGAwEDAW1BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHAGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEAB21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHAGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHAGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEAWpdbUEEBgEGFhMRaEMFAg0Eb0QBAgNVFGpGAwEGARFoQwUGA1BvRAEOB1AUFhNtQQQGAQYWB21BDwMCBWpGCQwAC21BAQBXURYTEWhDAQQEBBMABmpGCAQFAm1BDgsHDGpGBgdQVhEUFm9EBgMDAxQWExFmZW9EAQQDB2hDBQQDDhNtQQQGAQZqXW1BBAYEUWpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEAUm1BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHVWpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEAUm1BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEAUm1BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEAAm1aakYDAQYBERQWEwAUakYDAQYBEWx6dhEUakYDAQYBEQUCHQACExNtQQQGAQYWAQAaBQYUFBZvRAYDAwMUFgMfBQECBBRqRgMBBgFtWmpGAwEHUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYDAGpdbUEEBgEGFhMRFAQTbUEEBgEGFmt9dhYTbUEEBgEGFgsfDA4WERRqRgMBBgERBgMdBQYTExFoQwEEBAQTEQQYAgcBAxNtQQQGAQZqXW1BBAYAV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEEB21aakYDAQYBERQWEwIUakYDAQYBEWx6YxEUakYDAQYBEQwYBQYRFhNtQQQGAQYWAgYaAwAUFBZvRAYDAwMUFgMfBQQGERRqRgMBBgFtWmpGAwEHUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYDAGpdbUEEBgEGFhMRFAITbUEEBgEGFmt9fRYTbUEEBgEGFgYfBAAWERRqRgMBBgERBQAdAAUTExFoQwEEBAQTEQQYAwgNDhNtQQQGAQZqXW1BBAYAV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEEB21aakYDAQYBERQWEwQUakYDAQYBEWx6YXQUakYDAQYBEQAYAAMRFhNtQQQGAQYWCx8FBhYRFBZvRAYDAwMUFgMfBAMFABRqRgMBBgFtWmpGAwEHUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYDAGpdbUEEBgEGFhMRFAATbUEEBgEGFmt9YRYTbUEEBgEGFgUfAgUWERRqRgMBBgERABgFAxEWExFoQwEEBAQTEQQYAwQEBBNtQQQGAQZqXW1BBAYAV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEEB21aakYDAQYBERQWEwYUakYDAQYBEWx6ZREUakYDAQYBEQQYBwQRFhNtQQQGAQYWBx8HDhYRFBZvRAYDAwMUFgMfBAcLABRqRgMBBgFtWmpGAwEHUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYDAGpdbUEEBgEGFhMRFA4TbUEEBgEGFmt9dxYTbUEEBgEGFh4AGgIDFBRqRgMBBgERBxgACBEWExFoQwEEBAQTEQQYAwEHDxNtQQQGAQZqXW1BBAYAV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEEB21aakYDAQYBERQWEwgUakYDAQYBEWx6ahEUakYDAQYBERkDHQIFExNtQQQGAQYWAh8DDxYRFBZvRAYDAwMUGwMfBAQABxRqRgMBBgFtWmpGAwEHUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYDAGpdbUEEBgEGFhMRBQYTbUEEBgEGFmt9chYTbUEEBgEGFh4EGgYDFBRqRgMBBgERBBgEBREWExFoQwEEBAQTHAQYAwMDBRNtQQQGAQZqXW1BBAYAV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYCV2pGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEFUG1BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEGA21BBAYBBGpGAwEEB21aakYDAQYBERQWAgAUakYDAQYBEWx6eBEUakYDAQYBERkCHQECExNtQQQGAQYWHgAaAgcUFBZvRAYDAwMUGwMfBAUABBRqRgMBBgFtWmpGAwEDC21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHA2pGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEABG1BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHA2pGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYHA2pGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEBGpGAwEDA21BBAYEVmpdbVpqRgQGAldtQQJWAQ1qRgQABldtQVBVAFVqRggBUlBtQQBQVAxqRgQHAgNtQQMEVVIWG3dbVUZCFHdBVFUfb19oQwZXDFVvRABTAwhoQwYFBFJvRFJQAlBoQwoBA1BvRAEHB1UbakYIUVICbUEDBwFQakYEAVdWERx3RV5dUhxzWFdQWlhfQEUdal1tWmpGCAwHC21BAwIFDGpGBwMBVW1BAwsFVWpGBAQGUW1BDgNQBWpGBlZTCm1BDwMGDBYbZVtGE2JRVUdeRhZgRVtVWBFnVUFUUVgabVpqRgZWUwptQQ8DBgxqRgdVBwptQQBWCAIME21BAwNXDWpGBwwFUBEKFgYBcXtyERIWAQBxe3IRHGpGCVBXC21BAwFUBh8fEWhDBVJRBG9EAQRXBGhDBQQHAG9EA1MBVBQecF5dWlpfUx9vXwkLDgwJCw4MCQsODAkLDgwJCw4MCQsODAkLDgwJCw4MCQsODAkLDgwJCw4MCQsODAkLDgwJCw4MCQsODGhYb19oQwUGA1BvRAEOB1AOFmt9cWpdZV1VWFRGFhMRFGJBVFpSExEUFmVeWBYTERQWZV5YFhZtWhseHBkbHhwZFhMcGRseHBkbExEZGx4cGRsTERkbHhwZGx5tWm58fBQWExEUFhN+FBYTERQWExF6WUFcVVoTEQYYAQgRal1yYm4TERQWExEUeRMRFBYTERQWfV5GW1JdFBYCHwIHFm1adXxhFBYTERQWE34UFhMRFBYTEXpZQVxVWhMRBhgDBxFqXXR7cRMRFBYTERR5ExEUFhMRFBZ9XkZbUl0UFgEfAA4WbVplf3MUFhMRFBYTfhQWExEUFhMRellBXFVaExEGGAYCEWpdfGR1ExEUFhMRFHkTERQWExEUFn1eRltSXRQWAB8GAxZtWmZgaRQWExEUFhN+FBYTERQWExF6WUFcVVoTEQYYBQMRal1neHkTERQWExEUeRMRFBYTERQWfV5GW1JdFBYBHwwGFm1aeWtoFBYTERQWE34UFhMRFBYTEXpZQVxVWhMRBhgGAxFqXWZ5dBMRFBYTERR5ExEUFhMRFBZ9XkZbUl0UFgEfAwQWbVpqXW1BAAQGUmpGBAwCUgsUbn9zaFhnWFddVkMUFhMRYERWX1AWExEUYFxdFBYTERRgXF0UE29fGRseHBkbHhwUFh4cGRseHBkWExwZGx4cGRYTHBkbHhwZG29feH99ERQWExEUFnwRFBYTERQWE39bRF5QWBYTAxoDABRoWGB5YxYTERQWExF7FhMRFBYTERR4XENZV18RFAcdCQcTb19ydWsRFBYTERQWfBEUFhMRFBYTf1tEXlBYFhMFGgAGFGhYcmFwFhMRFBYTEXsWExEUFhMRFHhcQ1lXXxEUBB0HAhNvX3F1fxEUFhMRFBZ8ERQWExEUFhN/W0ReUFgWEwMaAQMUaFh9dHkWExEUFhMRexYTERQWExEUeFxDWVdfERQCHQMFE29fcHlkERQWExEUFnwRFBYTERQWE39bRF5QWBYTBRoDChRoWHBlYncTERQWExF7FhMRFBYTERR4XENZV18RFAQdAAwTb19kZnQRFBYTERQWfBEUFhMRFBYTf1tEXlBYFhMAGg8HFGhYb19oQwUGA1BvRAEOB1AOFmt9ZGpdZV1VWFRGFhMRFGJBVFpSExEUFmVeWBYTERQWZV5YFhZtWhseHBkbHhwZFhMcGRseHBkbExEZGx4cGRsTERkbHhwZGx5tWmZ0ERQWExEUFhN+FBYTERQWExF6WUFcVVoTEQYYAwERal1ye2VnERQWExEUeRMRFBYTERQWfV5GW1JdFBYBHwEOFm1aZnZhFBYTERQWE34UFhMRFBYTEXpZQVxVWhMRBhgHABFqXWZ5YhMRFBYTERR5ExEUFhMRFBZ9XkZbUl0UFgEfAwUWbVp9fBEUFhMRFBYTfhQWExEUFhMRellBXFVaExEGGAIEEWpdYXkWExEUFhMRFHkTERQWExEUFn1eRltSXRQWAR8BARZtWnt3fW4WExEUFhN+FBYTERQWExF6WUFcVVoTEQYYBwERal1yeBYTERQWExEUeRMRFBYTERQWfV5GW1JdFBYBHwQGFm1ae3wRFBYTERQWE34UFhMRFBYTEXpZQVxVWhMRBhgGBhFqXWVzYhMRFBYTERR5ExEUFhMRFBZ9XkZbUl0UFgEfDQ4WE0k=</div>

    <script>
        function unlock() {
            const pin = document.getElementById('pin-input').value;
            const encryptedData = document.getElementById('encrypted-data').innerText;
            const errorMsg = document.getElementById('error-msg');
            
            try {
                const decryptedJSON = simple_decrypt(encryptedData, pin);
                const data = JSON.parse(decryptedJSON);
                
                // If parse successful, show content
                document.getElementById('login-area').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                
                // Set session storage for detail pages
                sessionStorage.setItem('unlocked', 'true');
                
                // Populate Raw Report
                document.getElementById('raw-report').innerText = data.report_text;
                
                // Populate Table
                const tableBody = document.querySelector('#sector-table tbody');
                data.sectors.forEach(sector => {
                    const tr = document.createElement('tr');
                    
                    const p4Class = sector.perf_4w >= 0 ? 'metric-pos' : 'metric-neg';
                    const p12Class = sector.perf_12w >= 0 ? 'metric-pos' : 'metric-neg';
                    const scoreClass = sector.score > 0 ? 'metric-pos' : 'metric-neg';
                    
                    tr.innerHTML = `
                        <td>${sector.rank}</td>
                        <td><a href="pages/${sector.ticker}.html">${sector.ticker}</a></td>
                        <td>${sector.name}</td>
                        <td class="${p4Class}">${(sector.perf_4w * 100).toFixed(2)}%</td>
                        <td class="${p12Class}">${(sector.perf_12w * 100).toFixed(2)}%</td>
                        <td class="${scoreClass}"><strong>${sector.score.toFixed(4)}</strong></td>
                    `;
                    tableBody.appendChild(tr);
                });
                
                // Initialize DataTables
                $('#sector-table').DataTable({
                    paging: false,
                    searching: true,
                    info: false,
                    order: [[ 0, "asc" ]] // Sort by Rank by default
                });
                
                errorMsg.style.display = 'none';
                
            } catch (e) {
                errorMsg.style.display = 'block';
                console.error(e);
            }
        }

        function simple_decrypt(base64Text, pin) {
            const encryptedBytes = Uint8Array.from(atob(base64Text), c => c.charCodeAt(0));
            const encoder = new TextEncoder();
            const pinBytes = encoder.encode(pin);
            const keyBytes = new Uint8Array(encryptedBytes.length);
            
            for (let i = 0; i < encryptedBytes.length; i++) {
                keyBytes[i] = pinBytes[i % pinBytes.length];
            }
            
            const decryptedBytes = new Uint8Array(encryptedBytes.length);
            for (let i = 0; i < encryptedBytes.length; i++) {
                decryptedBytes[i] = encryptedBytes[i] ^ keyBytes[i];
            }
            
            const decoder = new TextDecoder();
            return decoder.decode(decryptedBytes);
        }
        
        // Auto-login via session
        if (sessionStorage.getItem('unlocked')) {
             // We can't auto-decrypt because we don't store the PIN in session for security (or maybe we could?)
             // Actually, if we want auto-show, we'd need the PIN. 
             // Let's just focus on the 'Enter PIN' UX for now, it's safer.
             // But we authorize detail pages if this main page was unlocked once? 
             // The detail pages check sessionStorage. 
             // But to view THIS page again, you need to decrypt data again.
             // Unless we store the DECRYPTED key or PIN in sessionStorage.
             // Let's store the PIN in sessionStorage temporarily for convenience.
             const storedPin = sessionStorage.getItem('session_pin');
             if (storedPin) {
                 document.getElementById('pin-input').value = storedPin;
                 // Ideally trigger unlock automatically, but we need the DOM to be ready.
                 // We'll let user click or hit enter, prepopulating is helpful enough.
             }
        }
        
        document.getElementById('pin-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                unlock();
                sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
            }
        });
        
        // Also save pin on click
        document.querySelector('button').addEventListener('click', function() {
             sessionStorage.setItem('session_pin', document.getElementById('pin-input').value);
        });
    </script>
</body>
</html>
    